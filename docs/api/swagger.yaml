openapi: 3.0.3
info:
  title: Nice Patrol API
  description: |
    API documentation for Nice Patrol System - Security Management Platform
    
    ## Authentication
    This API uses Bearer Token authentication. Include the token in the Authorization header:
    ```
    Authorization: Bearer {your_token}
    ```
    
    ## Base URLs
    - **Local**: `http://localhost:8000/api/v1`
    - **Development**: `https://devapi.nicepatrol.id/api/v1` (Laptop - akan mati jika laptop off)
    - **Staging**: `https://stagapi.nicepatrol.id/api/v1` (Server staging - **RECOMMENDED untuk testing**)
    - **Production**: `https://apiv1.nicepatrol.id/api/v1` (Live server)
    
    ## Multi-Tenancy
    All endpoints automatically filter data based on the authenticated user's company (perusahaan_id).
    Only superadmin can access data across all companies.
    
    ## Response Format
    All responses follow this standard format:
    ```json
    {
      "success": true,
      "message": "Operation successful",
      "data": {
        // Response data here
      }
    }
    ```
    
    ## Error Handling
    Error responses include appropriate HTTP status codes and error details:
    ```json
    {
      "success": false,
      "message": "Error message",
      "errors": {
        "field": ["Validation error details"]
      }
    }
    ```
  version: 1.0.0
  contact:
    name: Nice Patrol Support
    email: support@nicepatrol.id
  license:
    name: Proprietary
    
servers:
  - url: http://localhost:8000/api/v1
    description: Local development server
  - url: https://devapi.nicepatrol.id/api/v1
    description: Development server (Laptop - unstable, mati jika laptop off)
  - url: https://stagapi.nicepatrol.id/api/v1
    description: Staging server (Recommended untuk testing)
  - url: https://apiv1.nicepatrol.id/api/v1
    description: Production server (Live)

security:
  - BearerAuth: []

paths:
  # Authentication Endpoints
  /login:
    post:
      tags:
        - Authentication
      summary: User login
      description: Authenticate user and get access token
      security: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  example: edy@gmail.com
                password:
                  type: string
                  format: password
                  example: 12345678
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Login berhasil
                  data:
                    type: object
                    properties:
                      user:
                        $ref: '#/components/schemas/User'
                      token:
                        type: string
                        example: 1|abc123def456...
        '401':
          $ref: '#/components/responses/Unauthorized'
        '403':
          $ref: '#/components/responses/Forbidden'

  /logout:
    post:
      tags:
        - Authentication
      summary: User logout
      description: Logout user and invalidate current token
      responses:
        '200':
          description: Logout successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Logout berhasil

  /me:
    get:
      tags:
        - Authentication
      summary: Get current user
      description: Get authenticated user information
      responses:
        '200':
          description: User information retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/User'

  /user:
    get:
      tags:
        - Authentication
      summary: Get current user (alias)
      description: Alias for /me endpoint
      responses:
        '200':
          description: User information retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/User'

  /user/upload-photo:
    post:
      tags:
        - Authentication
      summary: Upload user photo
      description: Upload and compress user profile photo
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - foto
              properties:
                foto:
                  type: string
                  format: binary
                  description: Image file (JPEG, PNG, JPG, GIF, WEBP, max 10MB)
      responses:
        '200':
          description: Photo uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Foto berhasil diupload dan dikompres
                  data:
                    type: object
                    properties:
                      foto_url:
                        type: string
                        example: https://api.nicepatrol.id/storage/karyawan/foto/compressed_image.jpg
                      foto_path:
                        type: string
                        example: karyawan/foto/compressed_image.jpg

  # Shift Schedule Endpoints
  /shift/my-schedule:
    get:
      tags:
        - Shift Schedule
      summary: Get my shift schedule
      description: Get current user's shift schedule
      parameters:
        - name: date
          in: query
          description: Date to get schedule for (YYYY-MM-DD)
          schema:
            type: string
            format: date
            example: "2024-01-17"
        - name: month
          in: query
          description: Month to get schedule for (YYYY-MM)
          schema:
            type: string
            example: "2024-01"
      responses:
        '200':
          description: Shift schedule retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/ShiftSchedule'

  /shift/today:
    get:
      tags:
        - Shift Schedule
      summary: Get today's shift
      description: Get current user's shift for today
      responses:
        '200':
          description: Today's shift retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/ShiftSchedule'

  # Absensi Endpoints
  /absensi/summary:
    get:
      tags:
        - Absensi
      summary: Get absensi summary
      description: Get attendance summary for current user
      parameters:
        - name: month
          in: query
          description: Month to get summary for (YYYY-MM)
          schema:
            type: string
            example: "2024-01"
      responses:
        '200':
          description: Absensi summary retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/AbsensiSummary'

  /absensi/my-schedule:
    get:
      tags:
        - Absensi
      summary: Get my absensi schedule
      description: Get current user's attendance schedule
      parameters:
        - name: month
          in: query
          description: Month to get schedule for (YYYY-MM)
          schema:
            type: string
            example: "2024-01"
      responses:
        '200':
          description: Absensi schedule retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      month:
                        type: string
                        example: "2024-01"
                      schedules:
                        type: array
                        items:
                          $ref: '#/components/schemas/AbsensiSchedule'

  /absensi/lokasi:
    get:
      tags:
        - Absensi
      summary: Get absensi locations
      description: Get available attendance locations for current user's project
      responses:
        '200':
          description: Absensi locations retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/LokasiAbsensi'

  /absensi/today-status:
    get:
      tags:
        - Absensi
      summary: Check today's absensi status
      description: Check current user's attendance status for today
      responses:
        '200':
          description: Today's absensi status retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/AbsensiStatus'

  /absensi/check-in:
    post:
      tags:
        - Absensi
      summary: Check in
      description: Record attendance check-in with photo and location validation
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - lokasi_absensi_id
                - latitude
                - longitude
                - foto
              properties:
                lokasi_absensi_id:
                  type: integer
                  description: ID of attendance location
                  example: 1
                latitude:
                  type: number
                  format: float
                  description: Current GPS latitude
                  example: -6.2088
                longitude:
                  type: number
                  format: float
                  description: Current GPS longitude
                  example: 106.8456
                foto:
                  type: string
                  format: binary
                  description: Selfie photo (JPEG, PNG, JPG, max 2MB)
      responses:
        '200':
          description: Check-in successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Absensi masuk berhasil dicatat
                  data:
                    type: object
                    properties:
                      jam_masuk:
                        type: string
                        format: time
                        example: "08:00:00"
                      status:
                        type: string
                        enum: [hadir, terlambat]
                        example: hadir
                      lokasi:
                        type: string
                        example: "Kantor Pusat Jakarta"
                      on_radius:
                        type: boolean
                        example: true
                      distance:
                        type: number
                        format: float
                        example: 25.5
                        description: Distance from location in meters

  /absensi/check-out:
    post:
      tags:
        - Absensi
      summary: Check out
      description: Record attendance check-out with photo and location validation
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - lokasi_absensi_id
                - latitude
                - longitude
                - foto
              properties:
                lokasi_absensi_id:
                  type: integer
                  description: ID of attendance location
                  example: 1
                latitude:
                  type: number
                  format: float
                  description: Current GPS latitude
                  example: -6.2088
                longitude:
                  type: number
                  format: float
                  description: Current GPS longitude
                  example: 106.8456
                foto:
                  type: string
                  format: binary
                  description: Selfie photo (JPEG, PNG, JPG, max 2MB)
      responses:
        '200':
          description: Check-out successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Absensi keluar berhasil dicatat
                  data:
                    type: object
                    properties:
                      jam_keluar:
                        type: string
                        format: time
                        example: "17:00:00"
                      status:
                        type: string
                        enum: [hadir, terlambat, pulang_cepat]
                        example: hadir
                      lokasi:
                        type: string
                        example: "Kantor Pusat Jakarta"
                      durasi_kerja:
                        type: string
                        example: "9 jam 0 menit"
                      on_radius:
                        type: boolean
                        example: true
                      distance:
                        type: number
                        format: float
                        example: 30.2
                        description: Distance from location in meters

  /absensi/take-break:
    post:
      tags:
        - Absensi
      summary: Take break
      description: Record break start time with photo and location validation
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - lokasi_absensi_id
                - latitude
                - longitude
                - foto
              properties:
                lokasi_absensi_id:
                  type: integer
                  description: ID of attendance location
                  example: 1
                latitude:
                  type: number
                  format: float
                  description: Current GPS latitude
                  example: -6.2088
                longitude:
                  type: number
                  format: float
                  description: Current GPS longitude
                  example: 106.8456
                foto:
                  type: string
                  format: binary
                  description: Photo during break (JPEG, PNG, JPG, max 2MB)
      responses:
        '200':
          description: Break started successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Absensi istirahat berhasil dicatat
                  data:
                    type: object
                    properties:
                      jam_istirahat:
                        type: string
                        format: time
                        example: "12:00:00"
                      lokasi:
                        type: string
                        example: "Kantor Pusat Jakarta"
                      on_radius:
                        type: boolean
                        example: true
                      distance:
                        type: number
                        format: float
                        example: 15.8
                        description: Distance from location in meters

  /absensi/return-from-break:
    post:
      tags:
        - Absensi
      summary: Return from break
      description: Record break end time with photo and location validation
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - lokasi_absensi_id
                - latitude
                - longitude
                - foto
              properties:
                lokasi_absensi_id:
                  type: integer
                  description: ID of attendance location
                  example: 1
                latitude:
                  type: number
                  format: float
                  description: Current GPS latitude
                  example: -6.2088
                longitude:
                  type: number
                  format: float
                  description: Current GPS longitude
                  example: 106.8456
                foto:
                  type: string
                  format: binary
                  description: Photo when returning from break (JPEG, PNG, JPG, max 2MB)
      responses:
        '200':
          description: Returned from break successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Absensi kembali bekerja berhasil dicatat
                  data:
                    type: object
                    properties:
                      jam_kembali:
                        type: string
                        format: time
                        example: "13:00:00"
                      lokasi:
                        type: string
                        example: "Kantor Pusat Jakarta"
                      durasi_istirahat:
                        type: string
                        example: "1 jam 0 menit"
                      on_radius:
                        type: boolean
                        example: true
                      distance:
                        type: number
                        format: float
                        example: 18.3
                        description: Distance from location in meters

  # Lokasi Endpoints
  /lokasis:
    get:
      tags:
        - Lokasi
      summary: Get all locations
      description: Get all locations for current user's company
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            example: 1
        - name: per_page
          in: query
          description: Items per page
          schema:
            type: integer
            example: 20
        - name: search
          in: query
          description: Search term
          schema:
            type: string
            example: "Jakarta"
      responses:
        '200':
          description: Locations retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      current_page:
                        type: integer
                        example: 1
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Lokasi'
                      per_page:
                        type: integer
                        example: 20
                      total:
                        type: integer
                        example: 100

    post:
      tags:
        - Lokasi
      summary: Create new location
      description: Create a new location (admin only)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LokasiInput'
      responses:
        '201':
          description: Location created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Lokasi berhasil dibuat
                  data:
                    $ref: '#/components/schemas/Lokasi'

  /lokasis/{id}:
    get:
      tags:
        - Lokasi
      summary: Get location by ID
      description: Get specific location details
      parameters:
        - name: id
          in: path
          required: true
          description: Location hash ID
          schema:
            type: string
            example: "abc123def456"
      responses:
        '200':
          description: Location retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Lokasi'

    put:
      tags:
        - Lokasi
      summary: Update location
      description: Update existing location (admin only)
      parameters:
        - name: id
          in: path
          required: true
          description: Location hash ID
          schema:
            type: string
            example: "abc123def456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LokasiInput'
      responses:
        '200':
          description: Location updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Lokasi berhasil diupdate
                  data:
                    $ref: '#/components/schemas/Lokasi'

    delete:
      tags:
        - Lokasi
      summary: Delete location
      description: Delete existing location (admin only)
      parameters:
        - name: id
          in: path
          required: true
          description: Location hash ID
          schema:
            type: string
            example: "abc123def456"
      responses:
        '200':
          description: Location deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Lokasi berhasil dihapus

  # Checkpoint Endpoints
  /checkpoints:
    get:
      tags:
        - Checkpoint
      summary: Get all checkpoints
      description: Get all checkpoints for current user's company
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            example: 1
        - name: per_page
          in: query
          description: Items per page
          schema:
            type: integer
            example: 20
        - name: lokasi_id
          in: query
          description: Filter by location ID
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Checkpoints retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      current_page:
                        type: integer
                        example: 1
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Checkpoint'
                      per_page:
                        type: integer
                        example: 20
                      total:
                        type: integer
                        example: 50

    post:
      tags:
        - Checkpoint
      summary: Create new checkpoint
      description: Create a new checkpoint (admin only)
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CheckpointInput'
      responses:
        '201':
          description: Checkpoint created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Checkpoint berhasil dibuat
                  data:
                    $ref: '#/components/schemas/Checkpoint'

  /checkpoints/{id}:
    get:
      tags:
        - Checkpoint
      summary: Get checkpoint by ID
      description: Get specific checkpoint details
      parameters:
        - name: id
          in: path
          required: true
          description: Checkpoint hash ID
          schema:
            type: string
            example: "abc123def456"
      responses:
        '200':
          description: Checkpoint retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Checkpoint'

    put:
      tags:
        - Checkpoint
      summary: Update checkpoint
      description: Update existing checkpoint (admin only)
      parameters:
        - name: id
          in: path
          required: true
          description: Checkpoint hash ID
          schema:
            type: string
            example: "abc123def456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CheckpointInput'
      responses:
        '200':
          description: Checkpoint updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Checkpoint berhasil diupdate
                  data:
                    $ref: '#/components/schemas/Checkpoint'

    delete:
      tags:
        - Checkpoint
      summary: Delete checkpoint
      description: Delete existing checkpoint (admin only)
      parameters:
        - name: id
          in: path
          required: true
          description: Checkpoint hash ID
          schema:
            type: string
            example: "abc123def456"
      responses:
        '200':
          description: Checkpoint deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Checkpoint berhasil dihapus

  /checkpoints/{id}/asets:
    get:
      tags:
        - Checkpoint
      summary: Get checkpoint assets
      description: Get all assets for a specific checkpoint
      parameters:
        - name: id
          in: path
          required: true
          description: Checkpoint hash ID
          schema:
            type: string
            example: "abc123def456"
      responses:
        '200':
          description: Checkpoint assets retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/AsetCheckpoint'

  /checkpoints/{id}/aset-status:
    post:
      tags:
        - Checkpoint
      summary: Update asset status
      description: Update status of assets at checkpoint during patrol
      parameters:
        - name: id
          in: path
          required: true
          description: Checkpoint hash ID
          schema:
            type: string
            example: "abc123def456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - patroli_id
                - aset_statuses
              properties:
                patroli_id:
                  type: integer
                  example: 1
                aset_statuses:
                  type: array
                  items:
                    type: object
                    properties:
                      aset_id:
                        type: integer
                        example: 1
                      status:
                        type: string
                        enum: [baik, rusak, hilang]
                        example: baik
                      catatan:
                        type: string
                        example: Kondisi normal
      responses:
        '200':
          description: Asset status updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Status aset berhasil diupdate

  # Patroli Endpoints
  /patrolis:
    get:
      tags:
        - Patroli
      summary: Get all patrols
      description: Get all patrols for current user
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            example: 1
        - name: per_page
          in: query
          description: Items per page
          schema:
            type: integer
            example: 20
        - name: status
          in: query
          description: Filter by status
          schema:
            type: string
            enum: [aktif, selesai, dibatalkan]
            example: aktif
        - name: tanggal_mulai
          in: query
          description: Filter from date (YYYY-MM-DD)
          schema:
            type: string
            format: date
            example: "2024-01-01"
        - name: tanggal_selesai
          in: query
          description: Filter to date (YYYY-MM-DD)
          schema:
            type: string
            format: date
            example: "2024-01-31"
      responses:
        '200':
          description: Patrols retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      current_page:
                        type: integer
                        example: 1
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/Patroli'
                      per_page:
                        type: integer
                        example: 20
                      total:
                        type: integer
                        example: 100

    post:
      tags:
        - Patroli
      summary: Start new patrol
      description: Start a new patrol session
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PatroliInput'
      responses:
        '201':
          description: Patrol started successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Patroli berhasil dimulai
                  data:
                    $ref: '#/components/schemas/Patroli'

  /patrolis/{id}:
    get:
      tags:
        - Patroli
      summary: Get patrol by ID
      description: Get specific patrol details
      parameters:
        - name: id
          in: path
          required: true
          description: Patrol hash ID
          schema:
            type: string
            example: "abc123def456"
      responses:
        '200':
          description: Patrol retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/Patroli'

    put:
      tags:
        - Patroli
      summary: Update patrol
      description: Update patrol information or end patrol
      parameters:
        - name: id
          in: path
          required: true
          description: Patrol hash ID
          schema:
            type: string
            example: "abc123def456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
                  enum: [aktif, selesai, dibatalkan]
                  example: selesai
                catatan_selesai:
                  type: string
                  example: Patroli selesai tanpa insiden
                waktu_selesai:
                  type: string
                  format: date-time
                  example: "2024-01-17T18:00:00Z"
      responses:
        '200':
          description: Patrol updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Patroli berhasil diupdate
                  data:
                    $ref: '#/components/schemas/Patroli'

    delete:
      tags:
        - Patroli
      summary: Cancel patrol
      description: Cancel active patrol
      parameters:
        - name: id
          in: path
          required: true
          description: Patrol hash ID
          schema:
            type: string
            example: "abc123def456"
      responses:
        '200':
          description: Patrol cancelled successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Patroli berhasil dibatalkan

  /patrolis/{id}/scan:
    post:
      tags:
        - Patroli
      summary: Scan checkpoint during patrol
      description: Record checkpoint scan during active patrol
      parameters:
        - name: id
          in: path
          required: true
          description: Patrol hash ID
          schema:
            type: string
            example: "abc123def456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - checkpoint_id
                - latitude
                - longitude
              properties:
                checkpoint_id:
                  type: integer
                  example: 1
                latitude:
                  type: number
                  format: float
                  example: -6.2088
                longitude:
                  type: number
                  format: float
                  example: 106.8456
                foto:
                  type: string
                  format: binary
                  description: Photo taken at checkpoint
                catatan:
                  type: string
                  example: Kondisi normal, tidak ada masalah
                insiden:
                  type: boolean
                  example: false
                deskripsi_insiden:
                  type: string
                  example: Ditemukan pintu terbuka
      responses:
        '200':
          description: Checkpoint scanned successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Checkpoint berhasil discan
                  data:
                    $ref: '#/components/schemas/PatroliDetail'

  /patrolis/{id}/gps-locations:
    get:
      tags:
        - Patroli
      summary: Get patrol GPS locations
      description: Get GPS tracking data for a patrol
      parameters:
        - name: id
          in: path
          required: true
          description: Patrol hash ID
          schema:
            type: string
            example: "abc123def456"
      responses:
        '200':
          description: GPS locations retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/GpsLocation'

  /scan-qr:
    post:
      tags:
        - Patroli
      summary: Scan QR code
      description: Scan QR code to identify checkpoint or asset
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - qr_code
              properties:
                qr_code:
                  type: string
                  example: "checkpoint_abc123"
                latitude:
                  type: number
                  format: float
                  example: -6.2088
                longitude:
                  type: number
                  format: float
                  example: 106.8456
      responses:
        '200':
          description: QR code scanned successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      type:
                        type: string
                        enum: [checkpoint, aset]
                        example: checkpoint
                      checkpoint:
                        $ref: '#/components/schemas/Checkpoint'
                      aset:
                        $ref: '#/components/schemas/AsetCheckpoint'

  # Project Contacts Endpoints
  /projects/{project_id}/contacts:
    get:
      tags:
        - Project Contacts
      summary: Get project contacts
      description: Get all contacts for a specific project
      parameters:
        - name: project_id
          in: path
          required: true
          description: Project hash ID
          schema:
            type: string
            example: "abc123def456"
        - name: jenis
          in: query
          description: Filter by contact type
          schema:
            type: string
            enum: [emergency, security, management, vendor]
            example: emergency
      responses:
        '200':
          description: Project contacts retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/ProjectContact'

    post:
      tags:
        - Project Contacts
      summary: Create project contact
      description: Create a new contact for a project (admin only)
      parameters:
        - name: project_id
          in: path
          required: true
          description: Project hash ID
          schema:
            type: string
            example: "abc123def456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ProjectContactInput'
      responses:
        '201':
          description: Project contact created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Kontak berhasil ditambahkan
                  data:
                    $ref: '#/components/schemas/ProjectContact'

  /projects/{project_id}/contacts/emergency:
    get:
      tags:
        - Project Contacts
      summary: Get emergency contacts
      description: Get emergency contacts for a specific project
      parameters:
        - name: project_id
          in: path
          required: true
          description: Project hash ID
          schema:
            type: string
            example: "abc123def456"
      responses:
        '200':
          description: Emergency contacts retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      $ref: '#/components/schemas/ProjectContact'

  # Penerimaan Barang Endpoints
  /penerimaan-barang:
    get:
      tags:
        - Penerimaan Barang
      summary: Get list penerimaan barang
      description: Mendapatkan daftar penerimaan barang dengan pagination dan filter
      parameters:
        - name: page
          in: query
          description: Nomor halaman
          required: false
          schema:
            type: integer
            example: 1
        - name: per_page
          in: query
          description: Jumlah data per halaman (max 100)
          required: false
          schema:
            type: integer
            example: 20
        - name: kategori
          in: query
          description: Filter berdasarkan kategori barang
          required: false
          schema:
            type: string
            enum: [Dokumen, Material, Elektronik, Logistik]
        - name: kondisi
          in: query
          description: Filter berdasarkan kondisi barang
          required: false
          schema:
            type: string
            enum: [Baik, Rusak, Segel Terbuka]
        - name: project_id
          in: query
          description: Filter berdasarkan project ID
          required: false
          schema:
            type: integer
        - name: search
          in: query
          description: Pencarian berdasarkan nama barang atau nomor penerimaan
          required: false
          schema:
            type: string
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Data berhasil diambil
                  data:
                    type: object
                    properties:
                      current_page:
                        type: integer
                        example: 1
                      per_page:
                        type: integer
                        example: 20
                      total:
                        type: integer
                        example: 50
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/PenerimaanBarang'

    post:
      tags:
        - Penerimaan Barang
      summary: Create penerimaan barang baru
      description: Membuat data penerimaan barang baru
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - nama_barang
                - kategori_barang
                - jumlah_barang
                - satuan
                - kondisi_barang
                - pengirim
                - tujuan_departemen
                - tanggal_terima
              properties:
                project_id:
                  type: integer
                  description: ID Project
                  example: 1
                area_id:
                  type: integer
                  description: ID Area penyimpanan
                  example: 1
                pos:
                  type: string
                  description: Pos jaga security
                  example: Pos Jaga Utama
                nama_barang:
                  type: string
                  description: Nama barang
                  example: Laptop Dell Inspiron
                kategori_barang:
                  type: string
                  enum: [Dokumen, Material, Elektronik, Logistik]
                  example: Elektronik
                jumlah_barang:
                  type: integer
                  description: Jumlah barang
                  example: 2
                satuan:
                  type: string
                  description: Satuan barang
                  example: unit
                kondisi_barang:
                  type: string
                  enum: [Baik, Rusak, Segel Terbuka]
                  example: Baik
                pengirim:
                  type: string
                  description: Nama pengirim
                  example: PT. Supplier ABC
                tujuan_departemen:
                  type: string
                  description: Departemen tujuan
                  example: IT Department
                tanggal_terima:
                  type: string
                  format: date
                  description: Tanggal penerimaan
                  example: "2026-01-20"
                petugas_penerima:
                  type: string
                  description: Nama petugas penerima
                  example: John Doe
                keterangan:
                  type: string
                  description: Keterangan tambahan
                  example: Barang dalam kondisi baik
                foto_barang:
                  type: string
                  format: binary
                  description: Foto barang (max 10MB)
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Penerimaan barang berhasil dibuat
                  data:
                    $ref: '#/components/schemas/PenerimaanBarang'

  /penerimaan-barang/{id}:
    get:
      tags:
        - Penerimaan Barang
      summary: Get detail penerimaan barang
      description: Mendapatkan detail penerimaan barang berdasarkan ID
      parameters:
        - name: id
          in: path
          description: Hash ID penerimaan barang
          required: true
          schema:
            type: string
            example: abc123def456
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Data berhasil diambil
                  data:
                    $ref: '#/components/schemas/PenerimaanBarang'

    put:
      tags:
        - Penerimaan Barang
      summary: Update penerimaan barang
      description: Mengupdate data penerimaan barang
      parameters:
        - name: id
          in: path
          description: Hash ID penerimaan barang
          required: true
          schema:
            type: string
            example: abc123def456
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                _method:
                  type: string
                  example: PUT
                  description: Method override untuk form-data
                project_id:
                  type: integer
                  description: ID Project
                  example: 1
                area_id:
                  type: integer
                  description: ID Area penyimpanan
                  example: 1
                pos:
                  type: string
                  description: Pos jaga security
                  example: Pos Jaga Utama
                nama_barang:
                  type: string
                  description: Nama barang
                  example: Laptop Dell Inspiron
                kategori_barang:
                  type: string
                  enum: [Dokumen, Material, Elektronik, Logistik]
                  example: Elektronik
                jumlah_barang:
                  type: integer
                  description: Jumlah barang
                  example: 2
                satuan:
                  type: string
                  description: Satuan barang
                  example: unit
                kondisi_barang:
                  type: string
                  enum: [Baik, Rusak, Segel Terbuka]
                  example: Baik
                pengirim:
                  type: string
                  description: Nama pengirim
                  example: PT. Supplier ABC
                tujuan_departemen:
                  type: string
                  description: Departemen tujuan
                  example: IT Department
                tanggal_terima:
                  type: string
                  format: date
                  description: Tanggal penerimaan
                  example: "2026-01-20"
                petugas_penerima:
                  type: string
                  description: Nama petugas penerima
                  example: John Doe
                keterangan:
                  type: string
                  description: Keterangan tambahan
                  example: Barang dalam kondisi baik
                foto_barang:
                  type: string
                  format: binary
                  description: Foto barang baru (max 10MB)
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Penerimaan barang berhasil diupdate
                  data:
                    $ref: '#/components/schemas/PenerimaanBarang'

    delete:
      tags:
        - Penerimaan Barang
      summary: Delete penerimaan barang
      description: Menghapus data penerimaan barang (soft delete)
      parameters:
        - name: id
          in: path
          description: Hash ID penerimaan barang
          required: true
          schema:
            type: string
            example: abc123def456
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Penerimaan barang berhasil dihapus

  /penerimaan-barang-projects:
    get:
      tags:
        - Penerimaan Barang
      summary: Get list projects untuk dropdown
      description: Mendapatkan daftar project untuk dropdown penerimaan barang
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Data berhasil diambil
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1
                        nama:
                          type: string
                          example: Kantor Jakarta

  /penerimaan-barang-areas/{project_id}:
    get:
      tags:
        - Penerimaan Barang
      summary: Get list areas berdasarkan project
      description: Mendapatkan daftar area berdasarkan project untuk dropdown
      parameters:
        - name: project_id
          in: path
          description: ID Project
          required: true
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: Data berhasil diambil
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1
                        nama:
                          type: string
                          example: Gudang A
                        alamat:
                          type: string
                          example: Lantai 1

components:
  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  responses:
    Unauthorized:
      description: Unauthorized - Invalid or missing token
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              message:
                type: string
                example: Unauthenticated

    Forbidden:
      description: Forbidden - Insufficient permissions
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              message:
                type: string
                example: Akses ditolak

    NotFound:
      description: Resource not found
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              message:
                type: string
                example: Data tidak ditemukan

    ValidationError:
      description: Validation error
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              message:
                type: string
                example: Validation failed
              errors:
                type: object
                additionalProperties:
                  type: array
                  items:
                    type: string

  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
          example: 1
        name:
          type: string
          example: John Doe
        email:
          type: string
          format: email
          example: john@nicepatrol.id
        no_whatsapp:
          type: string
          nullable: true
          example: "+628123456789"
          description: "WhatsApp phone number for notifications"
        role:
          type: string
          enum: [superadmin, admin_perusahaan, security_officer, office_employee]
          example: security_officer
        role_display:
          type: string
          example: Security Officer
        perusahaan_id:
          type: integer
          example: 1
        foto:
          type: string
          nullable: true
          example: https://api.nicepatrol.id/storage/karyawan/foto/user1.jpg
        jabatan_name:
          type: string
          nullable: true
          example: Security Guard
        perusahaan:
          type: object
          nullable: true
          properties:
            id:
              type: integer
              example: 1
            nama:
              type: string
              example: PT. Nice Patrol Indonesia

    ShiftSchedule:
      type: object
      properties:
        id:
          type: integer
          example: 1
        tanggal:
          type: string
          format: date
          example: "2024-01-17"
        shift:
          type: object
          properties:
            id:
              type: integer
              example: 1
            nama:
              type: string
              example: Shift Pagi
            jam_masuk:
              type: string
              format: time
              example: "08:00:00"
            jam_keluar:
              type: string
              format: time
              example: "16:00:00"

    AbsensiSummary:
      type: object
      properties:
        summary:
          type: object
          properties:
            H:
              type: integer
              example: 18
              description: "Hadir"
            T:
              type: integer
              example: 2
              description: "Terlambat"
            PC:
              type: integer
              example: 1
              description: "Pulang Cepat"
            TPC:
              type: integer
              example: 0
              description: "Terlambat & Pulang Cepat"
            A:
              type: integer
              example: 1
              description: "Alpa/Tidak Hadir"
        total_jam_kerja:
          type: object
          properties:
            H:
              type: string
              example: "144 Jam 0 Menit"
              description: "Total jam kerja untuk status Hadir"
            T:
              type: string
              example: "16 Jam 30 Menit"
              description: "Total jam kerja untuk status Terlambat"
            PC:
              type: string
              example: "7 Jam 45 Menit"
              description: "Total jam kerja untuk status Pulang Cepat"
            TPC:
              type: string
              example: "0 Jam 0 Menit"
              description: "Total jam kerja untuk status Terlambat & Pulang Cepat"
            A:
              type: string
              example: "0 Jam 0 Menit"
              description: "Total jam kerja untuk status Alpa"

    AbsensiSchedule:
      type: object
      properties:
        tanggal:
          type: string
          format: date
          example: "2024-01-17"
        tanggal_formatted:
          type: string
          example: "Rabu, 17 Januari 2024"
        day_short:
          type: string
          example: "RAB"
        day_name:
          type: string
          example: "Rabu"
        day_number:
          type: integer
          example: 17
        absensi:
          type: object
          nullable: true
          properties:
            status:
              type: string
              enum: [H, T, PC, TPC, A]
              example: "H"
              description: "H=Hadir, T=Terlambat, PC=Pulang Cepat, TPC=Terlambat & Pulang Cepat, A=Alpa"
            status_display:
              type: string
              example: "Hadir"
            jam_masuk:
              type: string
              format: time
              nullable: true
              example: "08:00:00"
            jam_keluar:
              type: string
              format: time
              nullable: true
              example: "17:00:00"
            keterangan:
              type: string
              nullable: true
              example: null
            warna:
              type: string
              example: "#16a34a"
              description: "Color code for status display"

    LokasiAbsensi:
      type: object
      properties:
        id:
          type: integer
          example: 1
        hash_id:
          type: string
          example: "abc123def456"
        nama_lokasi:
          type: string
          example: "Kantor Pusat Jakarta"
        alamat:
          type: string
          example: "Jl. Sudirman No. 123, Jakarta"
        latitude:
          type: number
          format: float
          example: -6.2088
        longitude:
          type: number
          format: float
          example: 106.8456
        radius:
          type: integer
          example: 100
          description: "Allowed radius in meters"

    AbsensiStatus:
      type: object
      properties:
        can_check_in:
          type: boolean
          example: false
          description: "Whether user can perform check-in"
        can_take_break:
          type: boolean
          example: true
          description: "Whether user can take break"
        can_return_from_break:
          type: boolean
          example: false
          description: "Whether user can return from break"
        can_check_out:
          type: boolean
          example: false
          description: "Whether user can perform check-out"
        kehadiran:
          type: object
          nullable: true
          description: "Today's attendance record if exists"
          properties:
            jam_masuk:
              type: string
              format: time
              nullable: true
              example: "08:00:00"
            jam_keluar:
              type: string
              format: time
              nullable: true
              example: null
            jam_istirahat:
              type: string
              format: time
              nullable: true
              example: null
            jam_kembali:
              type: string
              format: time
              nullable: true
              example: null
            status:
              type: string
              enum: [hadir, terlambat, pulang_cepat, alpa, izin, sakit, cuti]
              example: "hadir"
            lokasi_masuk:
              type: string
              nullable: true
              example: "Kantor Pusat Jakarta"
            lokasi_keluar:
              type: string
              nullable: true
              example: null
            lokasi_istirahat:
              type: string
              nullable: true
              example: null
            lokasi_kembali:
              type: string
              nullable: true
              example: null

    Absensi:
      type: object
      properties:
        id:
          type: integer
          example: 1
        hash_id:
          type: string
          example: "abc123def456"
        karyawan_id:
          type: integer
          example: 1
        perusahaan_id:
          type: integer
          example: 1
        project_id:
          type: integer
          example: 1
        shift_id:
          type: integer
          nullable: true
          example: 1
        tanggal:
          type: string
          format: date
          example: "2024-01-17"
        jam_masuk:
          type: string
          format: time
          nullable: true
          example: "08:00:00"
        jam_keluar:
          type: string
          format: time
          nullable: true
          example: "17:00:00"
        jam_istirahat:
          type: string
          format: time
          nullable: true
          example: "12:00:00"
        jam_kembali:
          type: string
          format: time
          nullable: true
          example: "13:00:00"
        foto_masuk:
          type: string
          nullable: true
          example: "https://api.nicepatrol.id/storage/absensi/absensi_masuk_1_2024-01-17_08-00-00.jpg"
        foto_keluar:
          type: string
          nullable: true
          example: "https://api.nicepatrol.id/storage/absensi/absensi_keluar_1_2024-01-17_17-00-00.jpg"
        foto_istirahat:
          type: string
          nullable: true
          example: "https://api.nicepatrol.id/storage/absensi/absensi_istirahat_1_2024-01-17_12-00-00.jpg"
        foto_kembali:
          type: string
          nullable: true
          example: "https://api.nicepatrol.id/storage/absensi/absensi_kembali_1_2024-01-17_13-00-00.jpg"
        lokasi_masuk:
          type: string
          nullable: true
          example: "Kantor Pusat Jakarta"
        lokasi_keluar:
          type: string
          nullable: true
          example: "Kantor Pusat Jakarta"
        lokasi_istirahat:
          type: string
          nullable: true
          example: "Kantor Pusat Jakarta"
        lokasi_kembali:
          type: string
          nullable: true
          example: "Kantor Pusat Jakarta"
        status:
          type: string
          enum: [hadir, terlambat, pulang_cepat, alpa, izin, sakit, cuti]
          example: "hadir"
        keterangan:
          type: string
          nullable: true
          example: null
        durasi_kerja:
          type: integer
          nullable: true
          example: 540
          description: "Work duration in minutes"
        durasi_istirahat:
          type: integer
          nullable: true
          example: 60
          description: "Break duration in minutes"
        on_radius:
          type: boolean
          example: true
          description: "Legacy field for radius validation"
        on_radius_masuk:
          type: boolean
          example: true
          description: "Whether check-in was within allowed radius"
        on_radius_keluar:
          type: boolean
          example: true
          description: "Whether check-out was within allowed radius"
        jarak_masuk:
          type: integer
          nullable: true
          example: 25
          description: "Distance from location during check-in (meters)"
        jarak_keluar:
          type: integer
          nullable: true
          example: 30
          description: "Distance from location during check-out (meters)"
        latitude_masuk:
          type: number
          format: float
          nullable: true
          example: -6.2088
          description: "GPS latitude during check-in"
        longitude_masuk:
          type: number
          format: float
          nullable: true
          example: 106.8456
          description: "GPS longitude during check-in"
        latitude_keluar:
          type: number
          format: float
          nullable: true
          example: -6.2088
          description: "GPS latitude during check-out"
        longitude_keluar:
          type: number
          format: float
          nullable: true
          example: 106.8456
          description: "GPS longitude during check-out"
        map_absen_masuk:
          type: string
          nullable: true
          example: "https://www.google.com/maps?q=-6.2088,106.8456"
          description: "Google Maps URL for check-in location"
        map_absen_keluar:
          type: string
          nullable: true
          example: "https://www.google.com/maps?q=-6.2088,106.8456"
          description: "Google Maps URL for check-out location"
        sumber_data:
          type: string
          example: "mobile"
          description: "Data source (mobile/web/system)"
        created_at:
          type: string
          format: date-time
          example: "2024-01-17T08:00:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2024-01-17T17:00:00Z"

    Lokasi:
      type: object
      properties:
        id:
          type: integer
          example: 1
        hash_id:
          type: string
          example: "abc123def456"
        nama:
          type: string
          example: Gedung Perkantoran ABC
        alamat:
          type: string
          example: Jl. Sudirman No. 123, Jakarta
        latitude:
          type: number
          format: float
          example: -6.2088
        longitude:
          type: number
          format: float
          example: 106.8456
        deskripsi:
          type: string
          nullable: true
          example: Gedung perkantoran 20 lantai
        is_active:
          type: boolean
          example: true
        created_at:
          type: string
          format: date-time
          example: "2024-01-17T10:00:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2024-01-17T10:00:00Z"

    LokasiInput:
      type: object
      required:
        - nama
        - alamat
        - latitude
        - longitude
      properties:
        nama:
          type: string
          example: Gedung Perkantoran ABC
        alamat:
          type: string
          example: Jl. Sudirman No. 123, Jakarta
        latitude:
          type: number
          format: float
          example: -6.2088
        longitude:
          type: number
          format: float
          example: 106.8456
        deskripsi:
          type: string
          nullable: true
          example: Gedung perkantoran 20 lantai
        is_active:
          type: boolean
          example: true

    Checkpoint:
      type: object
      properties:
        id:
          type: integer
          example: 1
        hash_id:
          type: string
          example: "abc123def456"
        nama:
          type: string
          example: Checkpoint Lobby Utama
        kode:
          type: string
          example: CP001
        lokasi_id:
          type: integer
          example: 1
        latitude:
          type: number
          format: float
          example: -6.2088
        longitude:
          type: number
          format: float
          example: 106.8456
        deskripsi:
          type: string
          nullable: true
          example: Checkpoint di lobby utama gedung
        qr_code:
          type: string
          example: checkpoint_abc123def456
        is_active:
          type: boolean
          example: true
        lokasi:
          $ref: '#/components/schemas/Lokasi'
        created_at:
          type: string
          format: date-time
          example: "2024-01-17T10:00:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2024-01-17T10:00:00Z"

    CheckpointInput:
      type: object
      required:
        - nama
        - kode
        - lokasi_id
        - latitude
        - longitude
      properties:
        nama:
          type: string
          example: Checkpoint Lobby Utama
        kode:
          type: string
          example: CP001
        lokasi_id:
          type: integer
          example: 1
        latitude:
          type: number
          format: float
          example: -6.2088
        longitude:
          type: number
          format: float
          example: 106.8456
        deskripsi:
          type: string
          nullable: true
          example: Checkpoint di lobby utama gedung
        is_active:
          type: boolean
          example: true

    AsetCheckpoint:
      type: object
      properties:
        id:
          type: integer
          example: 1
        nama:
          type: string
          example: CCTV Camera 01
        kode:
          type: string
          example: CCTV001
        jenis:
          type: string
          example: CCTV
        deskripsi:
          type: string
          nullable: true
          example: CCTV untuk monitoring lobby
        status:
          type: string
          enum: [baik, rusak, hilang]
          example: baik
        qr_code:
          type: string
          example: aset_abc123def456

    Patroli:
      type: object
      properties:
        id:
          type: integer
          example: 1
        hash_id:
          type: string
          example: "abc123def456"
        lokasi_id:
          type: integer
          example: 1
        user_id:
          type: integer
          example: 1
        tanggal_patroli:
          type: string
          format: date
          example: "2024-01-17"
        waktu_mulai:
          type: string
          format: date-time
          example: "2024-01-17T08:00:00Z"
        waktu_selesai:
          type: string
          format: date-time
          nullable: true
          example: "2024-01-17T16:00:00Z"
        status:
          type: string
          enum: [aktif, selesai, dibatalkan]
          example: aktif
        catatan_mulai:
          type: string
          nullable: true
          example: Memulai patroli rutin
        catatan_selesai:
          type: string
          nullable: true
          example: Patroli selesai tanpa insiden
        total_checkpoint:
          type: integer
          example: 5
        checkpoint_selesai:
          type: integer
          example: 3
        lokasi:
          $ref: '#/components/schemas/Lokasi'
        user:
          $ref: '#/components/schemas/User'
        details:
          type: array
          items:
            $ref: '#/components/schemas/PatroliDetail'
        created_at:
          type: string
          format: date-time
          example: "2024-01-17T08:00:00Z"
        updated_at:
          type: string
          format: date-time
          example: "2024-01-17T16:00:00Z"

    PatroliInput:
      type: object
      required:
        - lokasi_id
        - tanggal_patroli
      properties:
        lokasi_id:
          type: integer
          example: 1
        tanggal_patroli:
          type: string
          format: date
          example: "2024-01-17"
        catatan_mulai:
          type: string
          nullable: true
          example: Memulai patroli rutin

    PatroliDetail:
      type: object
      properties:
        id:
          type: integer
          example: 1
        patroli_id:
          type: integer
          example: 1
        checkpoint_id:
          type: integer
          example: 1
        waktu_scan:
          type: string
          format: date-time
          example: "2024-01-17T08:30:00Z"
        latitude:
          type: number
          format: float
          example: -6.2088
        longitude:
          type: number
          format: float
          example: 106.8456
        foto:
          type: string
          nullable: true
          example: https://api.nicepatrol.id/storage/patroli/foto/scan_1.jpg
        catatan:
          type: string
          nullable: true
          example: Kondisi normal
        insiden:
          type: boolean
          example: false
        deskripsi_insiden:
          type: string
          nullable: true
          example: null
        checkpoint:
          $ref: '#/components/schemas/Checkpoint'

    GpsLocation:
      type: object
      properties:
        id:
          type: integer
          example: 1
        patroli_id:
          type: integer
          example: 1
        latitude:
          type: number
          format: float
          example: -6.2088
        longitude:
          type: number
          format: float
          example: 106.8456
        accuracy:
          type: number
          format: float
          nullable: true
          example: 5.0
        timestamp:
          type: string
          format: date-time
          example: "2024-01-17T08:15:00Z"

    ProjectContact:
      type: object
      properties:
        id:
          type: integer
          example: 1
        hash_id:
          type: string
          example: "abc123def456"
        project_id:
          type: integer
          example: 1
        nama:
          type: string
          example: John Doe
        jabatan:
          type: string
          example: Security Manager
        jenis:
          type: string
          enum: [emergency, security, management, vendor]
          example: emergency
        telepon:
          type: string
          example: "+62812345678"
        email:
          type: string
          format: email
          nullable: true
          example: john@company.com
        alamat:
          type: string
          nullable: true
          example: Jl. Sudirman No. 123, Jakarta
        catatan:
          type: string
          nullable: true
          example: Kontak darurat 24 jam
        is_active:
          type: boolean
          example: true

    ProjectContactInput:
      type: object
      required:
        - nama
        - jabatan
        - jenis
        - telepon
      properties:
        nama:
          type: string
          example: John Doe
        jabatan:
          type: string
          example: Security Manager
        jenis:
          type: string
          enum: [emergency, security, management, vendor]
          example: emergency
        telepon:
          type: string
          example: "+62812345678"
        email:
          type: string
          format: email
          nullable: true
          example: john@company.com
        alamat:
          type: string
          nullable: true
          example: Jl. Sudirman No. 123, Jakarta
        catatan:
          type: string
          nullable: true
          example: Kontak darurat 24 jam
        is_active:
          type: boolean
          example: true

    PenerimaanBarang:
      type: object
      properties:
        id:
          type: integer
          example: 1
        hash_id:
          type: string
          example: abc123def456
        perusahaan_id:
          type: integer
          example: 1
        project_id:
          type: integer
          nullable: true
          example: 1
        area_id:
          type: integer
          nullable: true
          example: 1
        pos:
          type: string
          nullable: true
          example: Pos Jaga Utama
        nomor_penerimaan:
          type: string
          example: PB202601200001
        nama_barang:
          type: string
          example: Laptop Dell Inspiron
        kategori_barang:
          type: string
          enum: [Dokumen, Material, Elektronik, Logistik]
          example: Elektronik
        jumlah_barang:
          type: integer
          example: 2
        satuan:
          type: string
          example: unit
        kondisi_barang:
          type: string
          enum: [Baik, Rusak, Segel Terbuka]
          example: Baik
        pengirim:
          type: string
          example: PT. Supplier ABC
        tujuan_departemen:
          type: string
          example: IT Department
        foto_barang:
          type: string
          nullable: true
          example: penerimaan-barang/foto/1768619162_696afc9a0f8d6.jpg
        foto_url:
          type: string
          nullable: true
          example: https://devapi.nicepatrol.id/storage/penerimaan-barang/foto/1768619162_696afc9a0f8d6.jpg
        tanggal_terima:
          type: string
          format: datetime
          example: "2026-01-20T10:30:00.000000Z"
        formatted_tanggal_terima:
          type: string
          example: "20/01/2026 10:30"
        status:
          type: string
          example: Diterima
        petugas_penerima:
          type: string
          example: John Doe
        keterangan:
          type: string
          nullable: true
          example: Barang dalam kondisi baik
        created_at:
          type: string
          format: datetime
          example: "2026-01-20T10:30:00.000000Z"
        updated_at:
          type: string
          format: datetime
          example: "2026-01-20T10:30:00.000000Z"
        project:
          type: object
          nullable: true
          properties:
            id:
              type: integer
              example: 1
            nama:
              type: string
              example: Kantor Jakarta
        area:
          type: object
          nullable: true
          properties:
            id:
              type: integer
              example: 1
            nama:
              type: string
              example: Gudang A
            alamat:
              type: string
              nullable: true
              example: Lantai 1

    BukuTamu:
      type: object
      properties:
        id:
          type: integer
          example: 1
        hash_id:
          type: string
          example: abc123def456
        perusahaan_id:
          type: integer
          example: 1
        project_id:
          type: integer
          nullable: true
          example: 1
        area_id:
          type: integer
          nullable: true
          example: 1
        area_patrol_id:
          type: integer
          nullable: true
          example: 1
        input_by:
          type: integer
          example: 1
        qr_code:
          type: string
          example: GT202601210001
        nama_tamu:
          type: string
          example: John Doe
        nik:
          type: string
          nullable: true
          example: "1234567890123456"
        tanggal_lahir:
          type: string
          format: date
          nullable: true
          example: "1990-01-15"
        domisili:
          type: string
          nullable: true
          example: Jakarta Selatan
        perusahaan_tamu:
          type: string
          example: PT. ABC Corporation
        jabatan:
          type: string
          nullable: true
          example: Software Engineer
        email:
          type: string
          format: email
          nullable: true
          example: john.doe@abc.com
        no_whatsapp:
          type: string
          nullable: true
          example: "+6281234567890"
        kontak_darurat_telepon:
          type: string
          nullable: true
          example: "+6281234567891"
        kontak_darurat_nama:
          type: string
          nullable: true
          example: Jane Doe
        kontak_darurat_hubungan:
          type: string
          nullable: true
          example: Spouse
        keperluan:
          type: string
          example: Meeting with IT Department
        lokasi_dituju:
          type: string
          nullable: true
          example: IT Office - Floor 3
        bertemu:
          type: string
          nullable: true
          example: Manager IT
        mulai_kunjungan:
          type: string
          format: datetime
          example: "2026-01-21T09:00:00.000000Z"
        selesai_kunjungan:
          type: string
          format: datetime
          nullable: true
          example: "2026-01-21T17:00:00.000000Z"
        lama_kunjungan:
          type: string
          nullable: true
          example: "8 jam 0 menit"
        check_in:
          type: string
          format: datetime
          example: "2026-01-21T09:00:00.000000Z"
        check_out:
          type: string
          format: datetime
          nullable: true
          example: "2026-01-21T17:00:00.000000Z"
        status:
          type: string
          enum: [sedang_berkunjung, sudah_keluar]
          example: sedang_berkunjung
        no_kartu_pinjam:
          type: string
          nullable: true
          example: CARD001
        foto:
          type: string
          nullable: true
          example: buku-tamu/foto_1737456789_abc123.jpg
        foto_url:
          type: string
          nullable: true
          example: https://devapi.nicepatrol.id/storage/buku-tamu/foto_1737456789_abc123.jpg
        foto_identitas:
          type: string
          nullable: true
          example: buku-tamu/identitas/identitas_1737456789_def456.jpg
        foto_identitas_url:
          type: string
          nullable: true
          example: https://devapi.nicepatrol.id/storage/buku-tamu/identitas/identitas_1737456789_def456.jpg
        keterangan_tambahan:
          type: string
          nullable: true
          example: VIP guest
        catatan:
          type: string
          nullable: true
          example: Visit completed successfully
        created_at:
          type: string
          format: datetime
          example: "2026-01-21T09:00:00.000000Z"
        updated_at:
          type: string
          format: datetime
          example: "2026-01-21T09:00:00.000000Z"
        project:
          type: object
          nullable: true
          properties:
            id:
              type: integer
              example: 1
            nama:
              type: string
              example: Kantor Jakarta
        area:
          type: object
          nullable: true
          properties:
            id:
              type: integer
              example: 1
            nama:
              type: string
              example: Lobby Utama
            alamat:
              type: string
              nullable: true
              example: Lantai 1
        inputBy:
          type: object
          nullable: true
          properties:
            id:
              type: integer
              example: 1
            name:
              type: string
              example: Security Officer

  # Buku Tamu (Guest Book) Endpoints
  /buku-tamu:
    get:
      tags:
        - Buku Tamu
      summary: Get all guest book entries
      description: Get paginated list of guest book entries with filtering options
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            example: 1
        - name: per_page
          in: query
          description: Items per page (default 20)
          schema:
            type: integer
            example: 20
        - name: search
          in: query
          description: Search in guest name, NIK, email, company, etc.
          schema:
            type: string
            example: "John Doe"
        - name: project_id
          in: query
          description: Filter by project ID
          schema:
            type: integer
            example: 1
        - name: area_id
          in: query
          description: Filter by area ID
          schema:
            type: integer
            example: 1
        - name: status
          in: query
          description: Filter by status
          schema:
            type: string
            enum: [sedang_berkunjung, sudah_keluar]
            example: sedang_berkunjung
        - name: date_from
          in: query
          description: Filter from date (YYYY-MM-DD)
          schema:
            type: string
            format: date
            example: "2026-01-20"
        - name: date_to
          in: query
          description: Filter to date (YYYY-MM-DD)
          schema:
            type: string
            format: date
            example: "2026-01-21"
        - name: period
          in: query
          description: Filter by time period
          schema:
            type: string
            enum: [today, week, visiting]
            example: today
      responses:
        '200':
          description: Guest book entries retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      current_page:
                        type: integer
                        example: 1
                      data:
                        type: array
                        items:
                          $ref: '#/components/schemas/BukuTamu'
                      per_page:
                        type: integer
                        example: 20
                      total:
                        type: integer
                        example: 100

    post:
      tags:
        - Buku Tamu
      summary: Create new guest book entry
      description: Register a new guest with photo and optional questionnaire
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - project_id
                - nama_tamu
                - perusahaan_tamu
                - keperluan
                - foto
                - area_id
                - mulai_kunjungan
              properties:
                # Required fields
                project_id:
                  type: integer
                  description: Project ID
                  example: 1
                nama_tamu:
                  type: string
                  description: Guest name
                  example: "John Doe"
                perusahaan_tamu:
                  type: string
                  description: Guest company/institution
                  example: "PT. ABC Corporation"
                keperluan:
                  type: string
                  description: Purpose of visit
                  example: "Meeting with IT Department"
                foto:
                  type: string
                  format: binary
                  description: Guest photo (JPEG, PNG, JPG, max 2MB)
                area_id:
                  type: integer
                  description: Area/location ID
                  example: 1
                mulai_kunjungan:
                  type: string
                  format: datetime
                  description: Visit start time
                  example: "2026-01-21T09:00:00"
                
                # Optional fields for Simple mode
                selesai_kunjungan:
                  type: string
                  format: datetime
                  description: Visit end time (required for simple mode)
                  example: "2026-01-21T17:00:00"
                lama_kunjungan:
                  type: string
                  description: Visit duration
                  example: "8 jam 0 menit"
                
                # MIGAS mode fields (required when guest_book_mode = 'migas')
                nik:
                  type: string
                  description: National ID number (16 digits, required for MIGAS mode)
                  example: "1234567890123456"
                tanggal_lahir:
                  type: string
                  format: date
                  description: Date of birth (required for MIGAS mode)
                  example: "1990-01-15"
                domisili:
                  type: string
                  description: Domicile address (required for MIGAS mode)
                  example: "Jakarta Selatan"
                jabatan:
                  type: string
                  description: Job position (required for MIGAS mode)
                  example: "Software Engineer"
                foto_identitas:
                  type: string
                  format: binary
                  description: ID card photo (required for MIGAS mode)
                email:
                  type: string
                  format: email
                  description: Email address (required for MIGAS mode)
                  example: "john.doe@abc.com"
                no_whatsapp:
                  type: string
                  description: WhatsApp number (required for MIGAS mode)
                  example: "+6281234567890"
                kontak_darurat_telepon:
                  type: string
                  description: Emergency contact phone (required for MIGAS mode)
                  example: "+6281234567891"
                kontak_darurat_nama:
                  type: string
                  description: Emergency contact name (required for MIGAS mode)
                  example: "Jane Doe"
                kontak_darurat_hubungan:
                  type: string
                  description: Emergency contact relationship (required for MIGAS mode)
                  example: "Spouse"
                lokasi_dituju:
                  type: string
                  description: Destination location (required for MIGAS mode)
                  example: "IT Office - Floor 3"
                
                # Optional fields
                area_patrol_id:
                  type: integer
                  description: Area patrol ID
                  example: 1
                bertemu:
                  type: string
                  description: Person to meet
                  example: "Manager IT"
                no_kartu_pinjam:
                  type: string
                  description: Borrowed card number
                  example: "CARD001"
                keterangan_tambahan:
                  type: string
                  description: Additional notes
                  example: "VIP guest"
                catatan:
                  type: string
                  description: Internal notes
                  example: "Requires escort"
                
                # Mode settings
                guest_book_mode:
                  type: string
                  enum: [simple, migas, standard_migas]
                  description: Guest book mode
                  example: "simple"
                enable_questionnaire:
                  type: boolean
                  description: Enable questionnaire
                  example: true
                kuesioner_answers:
                  type: string
                  description: Questionnaire answers as JSON string
                  example: '{"1":"Ya","2":"Tidak ada"}'
      responses:
        '201':
          description: Guest registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Data tamu berhasil dicatat. QR Code: GT202601210001"
                  data:
                    $ref: '#/components/schemas/BukuTamu'
        '422':
          $ref: '#/components/responses/ValidationError'

  /buku-tamu/{id}:
    get:
      tags:
        - Buku Tamu
      summary: Get guest book entry by ID
      description: Get specific guest book entry details with relationships
      parameters:
        - name: id
          in: path
          required: true
          description: Guest book entry hash ID
          schema:
            type: string
            example: "abc123def456"
      responses:
        '200':
          description: Guest book entry retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/BukuTamu'

    put:
      tags:
        - Buku Tamu
      summary: Update guest book entry
      description: Update existing guest book entry
      parameters:
        - name: id
          in: path
          required: true
          description: Guest book entry hash ID
          schema:
            type: string
            example: "abc123def456"
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - nama_tamu
                - perusahaan_tamu
                - keperluan
                - area_id
                - mulai_kunjungan
                - status
              properties:
                nama_tamu:
                  type: string
                  example: "John Doe"
                perusahaan_tamu:
                  type: string
                  example: "PT. ABC Corporation"
                keperluan:
                  type: string
                  example: "Meeting with IT Department"
                area_id:
                  type: integer
                  example: 1
                mulai_kunjungan:
                  type: string
                  format: datetime
                  example: "2026-01-21T09:00:00"
                status:
                  type: string
                  enum: [sedang_berkunjung, sudah_keluar]
                  example: "sedang_berkunjung"
                foto:
                  type: string
                  format: binary
                  description: New guest photo (optional)
                foto_identitas:
                  type: string
                  format: binary
                  description: New ID card photo (optional)
      responses:
        '200':
          description: Guest book entry updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Data tamu berhasil diupdate"
                  data:
                    $ref: '#/components/schemas/BukuTamu'

    delete:
      tags:
        - Buku Tamu
      summary: Delete guest book entry
      description: Delete existing guest book entry and associated photos
      parameters:
        - name: id
          in: path
          required: true
          description: Guest book entry hash ID
          schema:
            type: string
            example: "abc123def456"
      responses:
        '200':
          description: Guest book entry deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Data tamu berhasil dihapus"

  /buku-tamu/{id}/check-out:
    post:
      tags:
        - Buku Tamu
      summary: Check out guest
      description: Mark guest as checked out with optional notes
      parameters:
        - name: id
          in: path
          required: true
          description: Guest book entry hash ID
          schema:
            type: string
            example: "abc123def456"
      requestBody:
        required: false
        content:
          application/json:
            schema:
              type: object
              properties:
                catatan:
                  type: string
                  description: Check-out notes
                  example: "Visit completed successfully"
      responses:
        '200':
          description: Guest checked out successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Tamu berhasil check out"
                  data:
                    type: object
                    properties:
                      status:
                        type: string
                        example: "sudah_keluar"
                      check_out:
                        type: string
                        example: "21 Jan 2026 17:00"
                      duration:
                        type: string
                        example: "8 jam 0 menit"

  /buku-tamu/qr/{qr_code}:
    get:
      tags:
        - Buku Tamu
      summary: Get guest by QR code
      description: Find guest book entry by QR code for quick access
      parameters:
        - name: qr_code
          in: path
          required: true
          description: QR code value
          schema:
            type: string
            example: "GT202601210001"
      responses:
        '200':
          description: Guest found by QR code
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    $ref: '#/components/schemas/BukuTamu'
        '404':
          description: QR code not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "QR Code tidak ditemukan"

  /buku-tamu-project-settings:
    get:
      tags:
        - Buku Tamu
      summary: Get project settings for guest book
      description: Get project-specific guest book configuration
      parameters:
        - name: project_id
          in: query
          required: true
          description: Project ID
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Project settings retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 1
                      nama:
                        type: string
                        example: "Kantor Jakarta"
                      guest_book_mode:
                        type: string
                        enum: [simple, migas, standard_migas]
                        example: "simple"
                      enable_questionnaire:
                        type: boolean
                        example: true

  /buku-tamu-kuesioner-by-area:
    get:
      tags:
        - Buku Tamu
      summary: Get questionnaire by project and area
      description: Get active questionnaire for specific project and area
      parameters:
        - name: project_id
          in: query
          required: true
          description: Project ID
          schema:
            type: integer
            example: 1
        - name: area_id
          in: query
          required: true
          description: Area ID
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Questionnaire retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      id:
                        type: integer
                        example: 1
                      judul:
                        type: string
                        example: "Kuesioner Keamanan"
                      deskripsi:
                        type: string
                        example: "Pertanyaan keamanan untuk tamu"
                      pertanyaans:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                              example: 1
                            pertanyaan:
                              type: string
                              example: "Apakah Anda membawa barang berbahaya?"
                            tipe_jawaban:
                              type: string
                              enum: [text, radio, checkbox, select]
                              example: "radio"
                            opsi_jawaban:
                              type: array
                              items:
                                type: string
                              example: ["Ya", "Tidak"]
                            is_required:
                              type: boolean
                              example: true
                            urutan:
                              type: integer
                              example: 1
        '404':
          description: Questionnaire not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "Kuesioner tidak ditemukan untuk project dan area ini"

  /buku-tamu/{id}/questionnaire:
    post:
      tags:
        - Buku Tamu
      summary: Save questionnaire answers
      description: Save or update questionnaire answers for existing guest
      parameters:
        - name: id
          in: path
          required: true
          description: Guest book entry hash ID
          schema:
            type: string
            example: "abc123def456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - kuesioner_answers
              properties:
                kuesioner_answers:
                  type: object
                  description: Questionnaire answers (question_id -> answer)
                  example:
                    "1": "Tidak"
                    "2": "Laptop, Handphone"
                    "3": "Ya"
      responses:
        '200':
          description: Questionnaire answers saved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Jawaban kuesioner berhasil disimpan"

  /buku-tamu-statistics:
    get:
      tags:
        - Buku Tamu
      summary: Get guest book statistics
      description: Get summary statistics for guest book entries
      responses:
        '200':
          description: Statistics retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: object
                    properties:
                      total_today:
                        type: integer
                        description: Total guests today
                        example: 15
                      visiting_now:
                        type: integer
                        description: Currently visiting guests
                        example: 8
                      total_week:
                        type: integer
                        description: Total guests this week
                        example: 75
                      total_all:
                        type: integer
                        description: Total guests all time
                        example: 1250

  /buku-tamu-available-cards:
    get:
      tags:
        - Buku Tamu
      summary: Get available guest cards
      description: Get list of available guest cards for assignment
      parameters:
        - name: project_id
          in: query
          required: true
          description: Project ID to filter cards
          schema:
            type: integer
            example: 1
      responses:
        '200':
          description: Available cards retrieved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  data:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                          example: 1
                        no_kartu:
                          type: string
                          example: "GT001"
                        jenis_kartu:
                          type: string
                          example: "Visitor"
                        warna:
                          type: string
                          example: "Biru"
                        keterangan:
                          type: string
                          example: "Kartu tamu standar"
                  meta:
                    type: object
                    properties:
                      total_available:
                        type: integer
                        example: 5
                      project_id:
                        type: integer
                        example: 1
        '400':
          description: Project ID required
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "Project ID required"

  /buku-tamu/{id}/assign-card:
    post:
      tags:
        - Buku Tamu
      summary: Assign guest card
      description: Assign available guest card to visitor
      parameters:
        - name: id
          in: path
          required: true
          description: Guest book entry hash ID
          schema:
            type: string
            example: "abc123def456"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - no_kartu
              properties:
                no_kartu:
                  type: string
                  description: Card number to assign
                  example: "GT001"
      responses:
        '200':
          description: Card assigned successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Kartu berhasil diberikan kepada tamu"
                  data:
                    type: object
                    properties:
                      no_kartu:
                        type: string
                        example: "GT001"
                      nama_tamu:
                        type: string
                        example: "John Doe"
                      status_kartu:
                        type: string
                        example: "dipinjam"
        '400':
          description: Card assignment failed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "Tamu sudah memiliki kartu: GT002"
        '404':
          description: Card not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "Kartu tidak ditemukan"

  /buku-tamu/{id}/return-card:
    post:
      tags:
        - Buku Tamu
      summary: Return guest card
      description: Mark guest card as returned and update availability
      parameters:
        - name: id
          in: path
          required: true
          description: Guest book entry hash ID
          schema:
            type: string
            example: "abc123def456"
      responses:
        '200':
          description: Card returned successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "Kartu berhasil dikembalikan"
        '400':
          description: No card to return
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  message:
                    type: string
                    example: "Tamu tidak memiliki kartu yang dipinjam"

tags:
  - name: Authentication
    description: User authentication and profile management
  - name: Shift Schedule
    description: Employee shift schedule management
  - name: Absensi
    description: Employee attendance management
  - name: Lokasi
    description: Location management
  - name: Checkpoint
    description: Security checkpoint management
  - name: Patroli
    description: Security patrol management
  - name: Project Contacts
    description: Project contact management
  - name: Penerimaan Barang
    description: Goods receipt management
  - name: Buku Tamu
    description: Guest book and visitor management